<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/@solana/pay@0.2.5/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
</head>
<body>
    <script>
    async function initPayment() {
        const reference = solanaWeb3.Keypair.generate().publicKey;
        const amount = new BigNumber({{ amount }});
        
        // ساخت Solana Pay URL
        const solanaPayUrl = SolanaPay.encodeURL({
            recipient: new solanaWeb3.PublicKey("{{ recipient }}"),
            amount,
            reference,
            label: "CCoin Commission",
            message: "Payment for airdrop commission"
        });
        
        // Deep link به Phantom
        const phantomUrl = `https://phantom.app/ul/v1/pay?params=${encodeURIComponent(JSON.stringify({
            url: solanaPayUrl
        }))}&redirect_link=${encodeURIComponent(window.location.origin + '/commission/success')}`;
        
        window.location.href = phantomUrl;
    }
    
    initPayment();
    </script>
</body>
</html>
