<button onclick="connectPhantom()">Connect Phantom</button>

<script>
async function connectPhantom() {
  try {
    // اگر از داخل تلگرام هستیم → userId بگیر
    const userId = window.Telegram?.WebApp?.initDataUnsafe?.user?.id || "guest";

    // آدرس callback روی سرور خودت
    const callbackUrl = encodeURIComponent(
      `https://ccoin-final.onrender.com/wallet/callback?userId=${userId}`
    );

    // deep link برای اپ Phantom (موبایل)
    const deepLink = `phantom://ul/v1/connect?redirect_link=${callbackUrl}`;

    // universal link (اگر اپ نصب نبود → سایت Phantom)
    const universalLink = `https://phantom.app/ul/v1/connect?redirect_link=${callbackUrl}`;

    // اول تلاش کن Phantom app باز بشه
    window.location.href = deepLink;

    // اگر کاربر Phantom نصب نداشت → بعد 1 ثانیه به universal link هدایت بشه
    setTimeout(() => {
      window.location.href = universalLink;
    }, 1000);
  } catch (err) {
    console.error("Phantom connect error:", err);
    alert("خطا در اتصال به Phantom Wallet");
  }
}
</script>
